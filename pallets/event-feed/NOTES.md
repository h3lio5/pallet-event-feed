### Possible Improvements

- **Distribute pruning**: Older events that don't lie in the 1 hour window are purged away at the end of every block execution inside the `on_finalize()` hook, which may slow down the network if there are too many events to be removed at that block. As an alternative, the pruning can instead be done within a `on_idle()` hook which only performs the pruning if there is any blockspace left for that particular block and postpone the pending pruning to the next block. This will however require a trade-off between accurately maintaining only events from the last hour and spreading the pruning load across multiple blocks.
- **Minimize storage writes**: The current implementation runs a loop and pops off the events that lie outside the 1 hour window one-by-one, performing multiple writes to the storage. Another alternative could be to modify the event feed in-memory and replace the older event feed in the storage with the new updated one using just one storage write.
